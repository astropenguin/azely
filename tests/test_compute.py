# standard library
from io import StringIO


# dependent packages
import pandas as pd
from azely.azel import compute
from pandas.testing import assert_frame_equal


# constants
data = """\
Asia/Tokyo,az,el,lst
2020-02-01 00:00:00+09:00,99.52798157601987,-21.44516907364186,0 days 19:10:12.608533200
2020-02-01 01:00:00+09:00,93.21559165012916,-7.692853010898757,0 days 20:10:22.464976800
2020-02-01 02:00:00+09:00,87.30341414103223,6.143892829677975,0 days 21:10:32.321420400
2020-02-01 03:00:00+09:00,81.06613575531007,19.91031334835268,0 days 22:10:42.177867600
2020-02-01 04:00:00+09:00,73.62523894065819,33.41543220124262,0 days 23:10:52.034311200
2020-02-01 05:00:00+09:00,63.46619994014618,46.310706776501064,0 days 00:11:01.890754800
2020-02-01 06:00:00+09:00,47.43407195994693,57.76941390976785,0 days 01:11:11.747202000
2020-02-01 07:00:00+09:00,19.915657325344565,65.6060796199044,0 days 02:11:21.603645600
2020-02-01 08:00:00+09:00,342.7262197628494,65.93894555780118,0 days 03:11:31.460092800
2020-02-01 09:00:00+09:00,314.16291478174213,58.52820265887207,0 days 04:11:41.316536400
2020-02-01 10:00:00+09:00,297.4815159151801,47.24054611455749,0 days 05:11:51.172980000
2020-02-01 11:00:00+09:00,287.0198079052378,34.41504376321436,0 days 06:12:01.029427200
2020-02-01 12:00:00+09:00,279.4393332868865,20.94050548054519,0 days 07:12:10.885870800
2020-02-01 13:00:00+09:00,273.14620592844636,7.186075663578957,0 days 08:12:20.742318000
2020-02-01 14:00:00+09:00,267.23464506387245,-6.650773650795312,0 days 09:12:30.598761600
2020-02-01 15:00:00+09:00,260.9797045361478,-20.41534427145242,0 days 10:12:40.455208800
2020-02-01 16:00:00+09:00,253.491852225022,-33.91478245742346,0 days 11:12:50.311652400
2020-02-01 17:00:00+09:00,243.22194882300013,-46.793916616365294,0 days 12:13:00.168096000
2020-02-01 18:00:00+09:00,226.9219605531444,-58.20303411581113,0 days 13:13:10.024543200
2020-02-01 19:00:00+09:00,198.87453671148103,-65.88687822561263,0 days 14:13:19.880986800
2020-02-01 20:00:00+09:00,161.4717570579082,-65.93054054434384,0 days 15:13:29.737434000
2020-02-01 21:00:00+09:00,133.28648719943655,-58.30233678736436,0 days 16:13:39.593877600
2020-02-01 22:00:00+09:00,116.90150420214667,-46.91544721519637,0 days 17:13:49.450324800
2020-02-01 23:00:00+09:00,106.59215723190304,-34.04536962878047,0 days 18:13:59.306768400
2020-02-02 00:00:00+09:00,99.08617418966456,-20.549911723352988,0 days 19:14:09.163215600
"""


# test functions
def test_compute():
    result = compute("NGC1068!", "ALMA AOS!", "2020-02-01", view="Tokyo", freq="1H")
    expected = pd.read_csv(StringIO(data), index_col=0)
    expected = expected.set_index(result.index)

    columns = ["az", "el"]
    assert_frame_equal(result[columns], expected[columns], check_less_precise=True)
